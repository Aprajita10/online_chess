{"ast":null,"code":"import * as Chess from 'chess.js';\nimport { BehaviorSubject } from 'rxjs';\nconst chess = new Chess();\nexport const gameSubject = new BehaviorSubject();\nexport function initGame() {\n  updateGame();\n}\nexport function handleMove(from, to) {\n  const promotions = chess.moves({\n    verbose: true\n  }).filter(m => m.promotion);\n  console.log(promotions);\n\n  if (promotions.some(p => `${p.from}:${p.to}` === `${from}:${to}`)) {\n    const pendingPromotion = {\n      from,\n      to,\n      color: promotions[0].color\n    };\n    updateGame(pendingPromotion);\n  }\n\n  const {\n    pendingPromotion\n  } = gameSubject.getValue();\n\n  if (!pendingPromotion) {\n    move(from, to);\n  }\n}\nexport function move(from, to, promotion) {\n  let tempMove = {\n    from,\n    to\n  };\n\n  if (promotion) {\n    tempMove.promotion = promotion;\n  }\n\n  const legalMove = chess.move(tempMove);\n\n  if (legalMove) {\n    updateGame();\n  }\n}\n\nfunction updateGame(pendingPromotion) {\n  const isGameOver = chess.game_over();\n  const newGame = {\n    board: chess.board(),\n    pendingPromotion,\n    isGameOver,\n    result: isGameOver ? getGameResult() : null\n  };\n  gameSubject.next(newGame);\n}\n\nfunction getGameResult() {\n  if (chess.in_check_mate()) {\n    const winner = chess.turn;\n  }\n}","map":{"version":3,"sources":["C:/Users/aprajita rtm/Desktop/chess/chess_App/src/Game.js"],"names":["Chess","BehaviorSubject","chess","gameSubject","initGame","updateGame","handleMove","from","to","promotions","moves","verbose","filter","m","promotion","console","log","some","p","pendingPromotion","color","getValue","move","tempMove","legalMove","isGameOver","game_over","newGame","board","result","getGameResult","next","in_check_mate","winner","turn"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,UAAvB;AACA,SAASC,eAAT,QAAgC,MAAhC;AAEA,MAAMC,KAAK,GAAG,IAAIF,KAAJ,EAAd;AAGA,OAAO,MAAMG,WAAW,GAAC,IAAIF,eAAJ,EAAlB;AAEP,OAAO,SAASG,QAAT,GAAmB;AACxBC,EAAAA,UAAU;AACX;AAED,OAAO,SAASC,UAAT,CAAoBC,IAApB,EAAyBC,EAAzB,EAA4B;AAClC,QAAMC,UAAU,GAACP,KAAK,CAACQ,KAAN,CAAY;AAC5BC,IAAAA,OAAO,EAAC;AADoB,GAAZ,EAEdC,MAFc,CAEPC,CAAC,IAAEA,CAAC,CAACC,SAFE,CAAjB;AAGAC,EAAAA,OAAO,CAACC,GAAR,CAAYP,UAAZ;;AACA,MAAGA,UAAU,CAACQ,IAAX,CAAgBC,CAAC,IAAG,GAAEA,CAAC,CAACX,IAAK,IAAGW,CAAC,CAACV,EAAG,EAAlB,KAErB,GAAED,IAAK,IAAGC,EAAG,EAFX,CAAH,EAIC;AACC,UAAMW,gBAAgB,GAAC;AAAEZ,MAAAA,IAAF;AAAOC,MAAAA,EAAP;AAAUY,MAAAA,KAAK,EAACX,UAAU,CAAC,CAAD,CAAV,CAAcW;AAA9B,KAAvB;AACAf,IAAAA,UAAU,CAACc,gBAAD,CAAV;AACA;;AACD,QAAM;AAACA,IAAAA;AAAD,MAAqBhB,WAAW,CAACkB,QAAZ,EAA3B;;AACA,MAAG,CAACF,gBAAJ,EAAqB;AACtBG,IAAAA,IAAI,CAACf,IAAD,EAAMC,EAAN,CAAJ;AAAc;AAEd;AACD,OAAO,SAASc,IAAT,CAAcf,IAAd,EAAmBC,EAAnB,EAAsBM,SAAtB,EAAgC;AACtC,MAAIS,QAAQ,GAAG;AAAChB,IAAAA,IAAD;AAAMC,IAAAA;AAAN,GAAf;;AACA,MAAGM,SAAH,EAAa;AACZS,IAAAA,QAAQ,CAACT,SAAT,GAAmBA,SAAnB;AACA;;AACD,QAAMU,SAAS,GAAGtB,KAAK,CAACoB,IAAN,CAAWC,QAAX,CAAlB;;AACA,MAAGC,SAAH,EAAa;AACbnB,IAAAA,UAAU;AACT;AACD;;AACD,SAASA,UAAT,CAAoBc,gBAApB,EAAqC;AACpC,QAAMM,UAAU,GAAGvB,KAAK,CAACwB,SAAN,EAAnB;AACA,QAAMC,OAAO,GAAC;AACbC,IAAAA,KAAK,EAAC1B,KAAK,CAAC0B,KAAN,EADO;AAEbT,IAAAA,gBAFa;AAGbM,IAAAA,UAHa;AAIbI,IAAAA,MAAM,EAAGJ,UAAU,GAAGK,aAAa,EAAhB,GAAoB;AAJ1B,GAAd;AAMC3B,EAAAA,WAAW,CAAC4B,IAAZ,CAAiBJ,OAAjB;AAED;;AAED,SAASG,aAAT,GAAwB;AACvB,MAAG5B,KAAK,CAAC8B,aAAN,EAAH,EAAyB;AACxB,UAAMC,MAAM,GAAG/B,KAAK,CAACgC,IAArB;AACA;AACD","sourcesContent":["import * as Chess from 'chess.js'\r\nimport { BehaviorSubject } from 'rxjs'\r\n\r\nconst chess = new Chess()\r\n\r\n\r\nexport const gameSubject=new BehaviorSubject()\r\n\r\nexport function initGame(){\r\n  updateGame()\r\n}\r\n\r\nexport function handleMove(from,to){\r\n\tconst promotions=chess.moves({\r\n\t\tverbose:true\r\n\t}).filter(m=>m.promotion)\r\n\tconsole.log(promotions )\r\n\tif(promotions.some(p=>`${p.from}:${p.to}`\r\n\t=== \r\n\t`${from}:${to}`)\r\n\t\t)\r\n\t\t{\r\n\t\t\tconst pendingPromotion={ from,to,color:promotions[0].color }\r\n\t\t\tupdateGame(pendingPromotion)\r\n\t\t}\r\n\t\tconst {pendingPromotion} = gameSubject.getValue()\r\n\t\tif(!pendingPromotion){\r\n\tmove(from,to)}\r\n\r\n}\r\nexport function move(from,to,promotion){\r\n\tlet tempMove = {from,to}\r\n\tif(promotion){\r\n\t\ttempMove.promotion=promotion\r\n\t}\r\n const legalMove =\tchess.move(tempMove )\r\n if(legalMove){\r\n\tupdateGame()\r\n }\r\n}\r\nfunction updateGame(pendingPromotion){\r\n\tconst isGameOver = chess.game_over()\r\n\tconst newGame={\r\n\t\tboard:chess.board(),\r\n\t\tpendingPromotion,\r\n\t\tisGameOver,\r\n\t\tresult : isGameOver ? getGameResult() :null\r\n\t}\r\n \tgameSubject.next(newGame)\r\n\r\n}\r\n\r\nfunction getGameResult(){\r\n\tif(chess.in_check_mate()){\r\n\t\tconst winner = chess.turn\r\n\t}\r\n}\r\n"]},"metadata":{},"sourceType":"module"}